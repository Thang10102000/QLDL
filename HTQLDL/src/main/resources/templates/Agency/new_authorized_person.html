<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
      lang="vi">

<head th:replace="fragments/html-head">
    <meta charset="utf-8">
    <title>Thêm mới thông tin liên hệ đại lý</title>
</head>

<body>
<div class="wrapper">
    <!-- Sidebar  -->
    <nav id="sidebar" th:replace="fragments/sidebar"></nav>

    <!-- Page Content  -->
    <div id="content">
        <div class="div-navbar" th:replace="fragments/div-navbar"></div>

        <div class="container-fluid ">
            <div class="heading">
                <h3>THÊM MỚI THÔNG TIN LIÊN HỆ ĐẠI LÝ</h3>
            </div>
            <div class="box box-primary">
                <div class="tab-content">
                    <form th:action="@{/new-authorized}" method="post">
                        <table class="table table-condensed col">
                            <tr>
                                <td style="width: 50%;"><label for="agencyName">Đại
                                    lý<b class="required">(*)</b>
                                </label> <select name="agencyName1" id="agencyName" class="form-control">
                                    <option th:each="ag : ${agency}" th:value="${ag.id}"
                                            th:text="${ag.agencyName}"></option>
                                </select></td>
                                <td><label for="agencyFullName">Họ và tên<b class="required">(*)</b></label> <input
                                        type="text" name="agencyFullName" class="form-control" placeholder="Họ và tên"
                                        id="agencyFullName" autocomplete="off"> <span class="required"
                                                                                id="fullNameMessage"></span></td>

                            </tr>
                            <tr>
                                <td><label for="birthday">Ngày sinh</label> <input
                                        type="text" name="birthday" class="form-control" placeholder="Ngày sinh"
                                        id="birthday" autocomplete="off"> <span class="required"
                                                                                id="birthdayMessage"></span></td>

                                <td><label for="position">Chức vụ</label> <input
                                        type="text" name="position" class="form-control" placeholder="Chức vụ"
                                        id="position" autocomplete="off"> <span class="required"
                                                                                id="positionMessage"></span></td>
                            </tr>
                            <tr>
                                <td><label for="phoneNumber">Số điện thoại<b class="required">(*)</b></label> <input
                                        type="text" name="phoneNumber" class="form-control"
                                        placeholder="Số điện thoại" id="phoneNumber" autocomplete="off"> <span
                                        class="required" id="phoneNumberMessage"></span></td>
                                <td><label for="type">Thông tin<b class="required">(*)</b></label>
                                    <select name="type" id="type" class="form-control">
                                        <option value="0">Người đại diện</option>
                                        <option value="1">Người ủy quyển</option>
                                        <option value="2">Đầu mối liên hệ</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td><label for="agencyEmail">Email<b class="required">(*)</b></label>
                                    <input type="text" name="agencyEmail" class="form-control" placeholder="Email"
                                           id="agencyEmail" autocomplete="off">
                                    <span class="required" id="emailMessage"></span>
                                </td>
                                <td><input type="hidden" id="newcreatedByAuthor" name="createdByAuthor"
                                           th:value="${#request.userPrincipal.Principal.users.username}">
                                </td>
                            </tr>
                            <tr class="control">
                                <td colspan='4' align='center'>
                                    <button type="submit" class="btn btn-primary" name="doNew" id="doNew">
                                        <i class="fa fa-plus-square"></i> Thêm mới
                                    </button>
                                    <a type="button" id="doBack" class="btn btn-primary button-control"
                                       th:href="@{/authorized}"><i class="fa fa-undo" aria-hidden="true"></i> Quay
                                        lại</a>
                                </td>
                            </tr>
                        </table>
                    </form>
                </div>
            </div>
        </div>

    </div>
</div>
<script src="/vasonline/js/custom_service.js"></script>
<script src="/vasonline/js/bootstrap-datepicker.min.js"></script>
<link rel="stylesheet" href="/vasonline/style/bootstrap-datepicker.min.css">
<script type="text/javascript">
    $(document).ready(function () {
        $('#sidebarCollapse').on('click', function () {
            $('#sidebar').toggleClass('active');
        });
        $("#agencyFullName , #phoneNumber, #agencyEmail").keydown(function () {
            $("#phoneNumberMessage").text("");
            $("#fullNameMessage").text("");
            $("#emailMessage").text("");
        });
        $("#birthday").datepicker({
            format: "dd/mm/yyyy",
            todayHighlight: true,
            endDate: 'today'
        });
    });
    $("#doNew").on('click', function (e) {
        var format = /[`!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/;
        const re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;        if (format.test($("#agencyFullName").val())) {
            $("#fullNameMessage").text("Họ tên chứa ký tự đặc biệt");
            $("#fullName").focus();
            return false;
        }
        if ($("#agencyFullName").val() === '') {
            $("#fullNameMessage").text("Bạn chưa nhập họ tên");
            $("#fullName").focus();
            return false;
        }
        if ($("#phoneNumber").val() === '') {
            $("#phoneNumberMessage").text("Bạn chưa nhập số thoại");
            $("#phoneNumber").focus();
            return false;
        }
        if ($("#phoneNumber").val() * 1 != $("#phoneNumber").val() || $("#phoneNumber").val().length < 9
            || $("#phoneNumber").val().length > 11) {
            $("#phoneNumberMessage").text("Số diện thoại không đúng định dạng");
            $("#phoneNumber").focus();
            return false;
        }
        if ($("#agencyEmail").val() === '') {
            $("#emailMessage").text("Bạn chưa nhập email");
            $("#agencyEmail").focus();
            return false;
        }
        if (re.test($("#agencyEmail").val())) {
            return true;
        }else {
            $("#emailMessage").text("Email không đúng định dạng");
            return false;
        }
        return true;
    })
    var invalidChars = ["-", "+", "e", ",", "."];
    $("#phoneNumber").on("keydown", function (e) {
        if (invalidChars.includes(e.key)) {
            e.preventDefault();
        }
    });
</script>
</body>

</html>