<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
	lang="vi">
<head th:replace="fragments/html-head">
<meta charset="utf-8">
<title>Quản lý mẫu tin nhắn</title>
</head>
<body>
	<input type="hidden" th:name="${_csrf.parameterName}"
		th:value="${_csrf.token}" />
	<div class="wrapper" sec:authorize="isAuthenticated()">
				<div class="box box-primary table-responsive"
					sec:authorize="hasAuthority('Quản lý tài khoản:Xem')">
					<form th:action="@{/admin/sms-management/edit}" method='POST'>
						<table class="table table-sm newSms" id="smstable" th:object="${smsData}">
							<tr>
								<td style="width: 50%;"><label for="shortcode">Tên mẫu <b class="required">(*)</b></label>
									<input
									type="text" class="form-control" placeholder="Short code"
									name="shortcode" id="shortcode" th:field="*{tempCode}" readonly>
										<span id="form-message" class="required"></span>
									</td>
								<td><label for="status">Trạng thái <b class="required">(*)</b></label>
									<select
									name="status" id="status" class="form-control">
										<option value="1" th:field="*{status}">Hiệu lực</option>
										<option value="0" th:field="*{status}">Không hiệu lực</option>
								</select>
									</td>
							</tr>
							<tr>
								<td><label for="startdate">Ngày bắt đầu <b class="required">(*)</b></label>
									<div class="input-group">
										<input type="text" class="form-control"
											placeholder="Start date" name="startdate" id="startdate" th:field="*{startDate}" autocomplete="off">
										<span id="messageStartdate" class="required"></span>
									</div></td>
								<td>
									<label for="enddate">Ngày kết thúc <b class="required">(*)</b></label>
										<input type="text" class="form-control" placeholder="End date"
											name="enddate" id="enddate" th:field="*{endDate}" autocomplete="off">
										<span id="messageEnddate" class="required"></span>
									</td>
							</tr>
							<tr>
							<tr>
								<td><label for="smsdescription">Mô tả</label> <div><textarea
										class="form-control" placeholder="Description"
										name="smsdescription" id="smsdescription" th:field="*{description}" autocomplete="off"></textarea>
									<span class="form-message"></span>
								</div></td>
								<td><label for="smscontent">Nội dung <b class="required">(*)</b></label>
									<textarea
										class="form-control" placeholder="Content" name="smscontent"
										id="smscontent" th:field="*{content}" autocomplete="off"></textarea>
										<span id="messageContent" class="required"></span>
									</td>
							</tr>
							<tr class='control'>
								<td colspan='4' align='center'>
									<button class="btn btn-primary button-control" id="doNew"
										type="submit">
										<i class="fa fa-plus-square"></i> CẬP NHẬT
									</button>&nbsp; <a class="btn btn-primary button-control"
									th:href="@{/admin/sms-management}" id="goBack"> <i
										class="fa fa-undo"></i> QUAY LẠI
								</a>&nbsp;
								</td>
							</tr>
						</table>
					</form>
				</div>
	</div>
	<link rel="stylesheet"
		href="/vasonline/style/bootstrap-datepicker.min.css">
	<script src="/vasonline/js/bootstrap-datepicker.min.js"></script>
	<script src="/vasonline/js/custom_service.js"></script>
	<script src="/vasonline/js/sms-search.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			$('#sidebarCollapse').on('click', function() {
				$('#sidebar').toggleClass('active');
			});
			$("#startdate, #enddate, #smscontent").keydown(function () {
				$("#messageStartdate").text("");
				$("#messageEnddate").text("");
				$("#messageContent").text("");
			})

		});

		$("#doNew").on('click', function (e) {
			if ($("#startdate").val().trim() === '') {
				$("#messageStartdate").text("Bạn chưa nhập ngày bắt đầu");
				$("#startdate").focus();
				return false;
			}
			if ($("#enddate").val().trim() === '') {
				$("#messageEnddate").text(
						"Bạn chưa nhập ngày kết thúc");
				$("#enddate").focus();
				return false;
			}
			if ($("#smscontent").val().trim() === '') {
				$("#messageContent").text(
						"Bạn chưa nhập nội dung tin nhắn");
				$("#smscontent").focus();
				return false;
			}
			var s = $.trim($('#startdate').val()).split('/');
			var e = $.trim($('#enddate').val()).split('/');
			if (!(parseInt(e[2]) > parseInt(s[2]) || (parseInt(e[2]) === parseInt(s[2]) && parseInt(e[1]) > parseInt(s[1])) || (parseInt(e[2]) === parseInt(s[2]) && parseInt(e[1]) === parseInt(s[1]) && parseInt(e[0]) > parseInt(s[0])))) {
				$("#messageEnddate").text("Bạn phải nhập ngày kết thúc lớn hơn ngày bắt đầu")
				$("#enddate").focus();
				return false;
			}

		});

		$("#startdate").datepicker({
			format : "dd/mm/yyyy",
			todayHighlight : true,
			inline : true
		});
		$("#enddate").datepicker({
			format : "dd/mm/yyyy",
			todayHighlight : true,
			inline : true
		});
	</script>
</body>

</html>